"""
Nombre: Patricia P√©rez Cruz
Fecha: 09 de febrero de 2025
Descripci√≥n: Implementaci√≥n del juego de Batalla Naval
Dos jugadores colocan estrat√©gicamente sus barcos en un tablero y luego intentan hundir los barcos del oponente
adivinando sus posiciones
Cada jugador tiene un tablero donde marca sus propios barcos y otro tablero donde
registra los disparos realizados al enemigo. El objetivo es hundir todos los barcos del oponente antes de que
√©l hunda los tuyos
"""


import random

victorias_jugador = 0
derrotas_jugador = 0
victorias_jugador2 = 0
derrotas_jugador2 = 0
victorias_cpu = 0
derrotas_cpu = 0
#Estos son mks diccionarios.
letras_columnas = {0: 'A', 1: 'B', 2: 'C', 3: 'D', 4: 'E'}


def convertir_coordenadas(barcos):
    return [(fila, letras_columnas[columna]) for fila, columna in barcos]

"""
Crea un tablero vac√≠o de 5x5 con s√≠mbolos '~', que representan el agua.

Returns:
 Tablero 5x5 con todas las celdas inicializadas en '~'.
"""

def crear_tablero():
    return [['~' for _ in range(5)] for _ in range(5)]

"""
Muestra el tablero en consola. Puede ocultar los barcos si as√≠ se solicita.

Args:
    tablero: Matriz 5x5 que representa el tablero.
    ocultar: Si es 1, oculta los barcos ('‚õµ') y los muestra como agua ('~').

Returns:
    None: Solo imprime el tablero en consola.
"""

def mostrar_tablero(tablero, ocultar):
    print("  A B C D E")
    fila_numero = 0
    for fila in tablero:
        print(fila_numero, end=' ')
        for celda in fila:
            if ocultar == 1 and celda == '‚õµ':
                print('~', end=' ')
            else:
                print(celda, end=' ')
        print()
        fila_numero += 1
"""
Solicita al jugador la cantidad de barcos a colocar (de 1 a 5) y asegura que la entrada sea v√°lida.

Returns:
La cantidad de barcos que el jugador desea colocar (entre 1 y 5).
"""

def obtener_cantidad_barcos():
    cantidad = 0
    while cantidad < 1 or cantidad > 5:
        entrada = input("¬øCu√°ntos barcos deseas colocar? (1-5): ")
        if entrada.isdigit():
            cantidad = int(entrada)
        if cantidad < 1 or cantidad > 5:
            print("Opci√≥n inv√°lida. Ingresa un n√∫mero entre 1 y 5,por favor.")
    return cantidad

"""
Coloca los barcos en el tablero en posiciones aleatorias.

Args:
tablero: El tablero en el que se colocar√°n los barcos.
cantidad: La cantidad de barcos a colocar en el tablero.

Returns:
Lista de coordenadas (fila, columna) donde los barcos fueron colocados.
"""

def colocar_barcos(tablero, cantidad):
    barcos = []
    while len(barcos) < cantidad:
        fila, columna = random.randint(0, 4), random.randint(0, 4)
        if tablero[fila][columna] == '~':
            tablero[fila][columna] = '‚õµ'
            barcos.append((fila, columna))
    return barcos
"""
Solicita al jugador que ingrese un n√∫mero de fila v√°lido (de 0 a 4).

Returns:
El n√∫mero de fila elegido por el jugador.
"""

def obtener_fila():
    numero = -1
    while numero < 0 or numero > 4:
        entrada = input("Ingresa fila (0-4): ")
        if entrada.isdigit():
            numero = int(entrada)
        if numero < 0 or numero > 4:
            print("Opci√≥n inv√°lida‚ùå‚ùå. Ingresa un n√∫mero entre 0 y 4,por favor.")
    return numero

"""
Solicita al jugador que ingrese una letra correspondiente a una columna v√°lida (de A a E).

Returns:
El n√∫mero de columna correspondiente a la letra ingresada (0 para A, 1 para B, etc.).
"""

def obtener_columna():
    letras = {'a': 0, 'b': 1, 'c': 2, 'd': 3, 'e': 4}
    columna = None
    while columna is None:
        entrada = input("Ingresa la  columna de: (A-E): ").lower()  # Convertimos a min√∫sculas
        if entrada in letras:
            columna = letras[entrada]
        else:
            print("Opci√≥n inv√°lida‚ùå‚ùå. Ingresa una letra entre A y E,por favor.")
    return columna

"""
Muestra el tablero con los barcos colocados en sus posiciones correspondientes.

Args:
    tablero: Matriz 5x5 que representa el tablero.
    barcos: Lista de coordenadas (fila, columna) de los barcos.

Returns:
    None: Solo imprime el tablero con los barcos en consola.
"""

def mostrar_tablero_con_barcos(tablero, barcos):
    """
    Muestra el tablero y coloca los barcos en sus posiciones
    utilizando el emoji ‚õµ.
    """
    for fila, columna in barcos:
        tablero[fila][columna] = '‚õµ'

    mostrar_tablero(tablero, ocultar=0)  # Mostrar el tablero completo (sin ocultar)
"""
Lleva a cabo una partida contra la CPU. El jugador trata de adivinar la ubicaci√≥n de los barcos enemigos.

Returns:
    None: Controla el flujo principal del juego contra la CPU.
"""

def jugar_contra_pc():
    global victorias_jugador, derrotas_jugador, victorias_cpu, derrotas_cpu
    print("Modo: Contra la PC")
    tablero_jugador = crear_tablero()
    tablero_cpu = crear_tablero()
    num_barcos = obtener_cantidad_barcos()
    barcos_cpu = colocar_barcos(tablero_cpu, num_barcos)
    intentos = 5
    barcos_restantes = num_barcos
    print("")
    print("‚ïè‚ï†‚ïê‚ïê[ùçñùçñùçñ ùöÇùöé ùöëùöäùöó ùöä√±ùöäùöçùöíùöçùöò ùöåùöòùöõùöõùöéùöåùöùùöäùöñùöéùöóùöùùöé ùöùùöûùöú ùöãùöäùöõùöåùöòùöú ùçñùçñùçñ]·öÄ·öÄ·öÄ·öÄ·öÄ·öÄüí¶")
    print(" ")
    print("--------------------------------------------------------------------")
    print("¬°Es momento de adivinar los barcos enemigos!")
    print("--------------------------------------------------------------------")
    while intentos > 0 and barcos_restantes > 0:
        print("\nTu tablero:")
        mostrar_tablero(tablero_jugador, 1)

        fila = obtener_fila()
        columna = obtener_columna()

        if tablero_jugador[fila][columna] != '~':
            print("Ya disparaste aqu√≠. Intenta otra vez,por favor.")
        else:
            if (fila, columna) in barcos_cpu:
                print("¬°Tocado y hundido!")
                tablero_jugador[fila][columna] = '‚õµ'
                barcos_restantes -= 1
            else:
                print("Aguaaaaa!")
                tablero_jugador[fila][columna] = 'X'
            intentos -= 1

    if barcos_restantes > 0:
        print("¬°Perdisteeeeüòû! Los barcos estaban en:", convertir_coordenadas(barcos_cpu))
        derrotas_jugador += 1
        victorias_cpu += 1
    else:
        print("¬°Ganasteeeeüòû! Hundiste todos los barcos.")
        victorias_jugador += 1
        derrotas_cpu += 1

    print("\nAqu√≠ est√°n las posiciones finales de los barcos‚õµ:")
    mostrar_tablero_con_barcos(tablero_cpu, barcos_cpu)  # Mostrar tablero con los barcos
    volver_a_jugar("pc", barcos_cpu)

"""
Lleva a cabo una partida entre dos jugadores. Ambos intentan hundir los barcos del otro.

Returns:
    None: Controla el flujo principal del juego entre dos jugadores.
"""
def jugar_contra_jugador():
    global victorias_jugador, derrotas_jugador, victorias_jugador2, derrotas_jugador2
    print("Estas en el modo: Contra otro jugadorü§©")
    tablero_jugador1 = crear_tablero()
    tablero_jugador2 = crear_tablero()
    num_barcos = obtener_cantidad_barcos()
    barcos_jugador1 = colocar_barcos(tablero_jugador1, num_barcos)
    barcos_jugador2 = colocar_barcos(tablero_jugador2, num_barcos)
    intentos = 5
    barcos_restantes_j1 = num_barcos
    barcos_restantes_j2 = num_barcos
    print("‚ïè‚ï†‚ïê‚ïê[ùçñùçñùçñ ùöÇùöé ùöëùöäùöó ùöä√±ùöäùöçùöíùöçùöò ùöåùöòùöõùöõùöéùöåùöùùöäùöñùöéùöóùöùùöé ùöùùöûùöú ùöãùöäùöõùöåùöòùöú ùçñùçñùçñ]·öÄ·öÄ·öÄ·öÄ·öÄ·öÄ‚õµ")
    print(" ")
    print("--------------------------------------------------------------------")
    print("¬°Es momento de adivinar los barcos‚õµ enemigos‚ùå!")
    print("--------------------------------------------------------------------")

    while intentos > 0 and (barcos_restantes_j1 > 0 and barcos_restantes_j2 > 0):
        # Turno del Jugador 1
        print("\nTurno del Jugador 1Ô∏è‚É£:")
        mostrar_tablero(tablero_jugador2, 1)

        fila = obtener_fila()
        columna = obtener_columna()

        if tablero_jugador2[fila][columna] == '~':
            if (fila, columna) in barcos_jugador2:
                print("¬°Tocado y hundido!")
                tablero_jugador2[fila][columna] = '‚õµ'
                barcos_restantes_j2 -= 1
            else:
                print("Aguaaaaa!")
                tablero_jugador2[fila][columna] = 'X'
        else:
            print("Ya disparasteüî´üî´ aqu√≠.")

        if barcos_restantes_j2 == 0:
            print("¬°Ganaste, Jugador 1! Hundiste todos los barcos del Jugador 2.")
            victorias_jugador += 1
            derrotas_jugador2 += 1
            break

        # Turno del Jugador 2
        print("\nTurno del Jugador 2Ô∏è‚É£:")
        mostrar_tablero(tablero_jugador1, 1)

        fila = obtener_fila()
        columna = obtener_columna()

        if tablero_jugador1[fila][columna] == '~':
            if (fila, columna) in barcos_jugador1:
                print("¬°Tocado y hundido!")
                tablero_jugador1[fila][columna] = '‚õµ'
                barcos_restantes_j1 -= 1
            else:
                print("Aguaaaaa!")
                tablero_jugador1[fila][columna] = 'X'
        else:
            print("Ya disparasteüî´üî´ aqu√≠.")

        if barcos_restantes_j1 == 0:
            print("¬°Ganaste, Jugador 2! Hundiste todos los barcos del Jugador 1.")
            victorias_jugador2 += 1
            derrotas_jugador += 1
            break

        intentos -= 1

    print("\n‚õµ‚õµ‚õµAqu√≠ est√°n las posiciones finales de los barcos‚õµ‚õµ‚õµ:")
    # Mostrar los barcos en sus posiciones finales para ambos jugadores
    print("\nTablero final del Jugador 1:")
    mostrar_tablero_con_barcos(tablero_jugador1, barcos_jugador1)
    print("\nTablero final del Jugador 2:")
    mostrar_tablero_con_barcos(tablero_jugador2, barcos_jugador2)

    volver_a_jugar("jugadores", barcos_jugador1, barcos_jugador2)


def volver_a_jugar(modo, barcos_jugador1=None, barcos_jugador2=None):
    if modo == "pc":
        print("\nüìäüìäEstad√≠sticasüìäüìä:")
        print(f"Jugador - Victorias: {victorias_jugador}, Derrotas: {derrotas_jugador}")
        print(f"CPU - Victorias: {victorias_cpu}, Derrotas: {derrotas_cpu}")
    else:
        print("\nüìäüìäEstad√≠sticasüìäüìä:")
        print(f"Jugador 1 - Victorias: {victorias_jugador}, Derrotas: {derrotas_jugador}")
        print(f"Jugador 2 - Victorias: {victorias_jugador2}, Derrotas: {derrotas_jugador2}")

        # Mostrar coordenadas de los barcos al final del juego
        print("\nüõ≥Ô∏èüõ≥Ô∏èCoordenadas de los barcosüõ≥Ô∏èüõ≥Ô∏è:")
        print(f"Jugador 1: {convertir_coordenadas(barcos_jugador1)}")
        print(f"Jugador 2: {convertir_coordenadas(barcos_jugador2)}")

    opcion = ""
    while opcion != '1' and opcion != '2':
        print("\n¬øüéÆüéÆQuieres volver a jugarüéÆüéÆ?")
        print("1. S√≠")
        print("2. No (Salir)")
        opcion = input("Selecciona una opci√≥n (1 o 2): ")
        if opcion == '1':
            jugar()
        elif opcion == '2':
            print("üéÆüéÆGracias por jugarüéÆüéÆ. ¬°Hasta la pr√≥xima!")
            return  # Aqu√≠ se termina la ejecuci√≥n del programa de manera sencilla.
        else:
            print("Opci√≥n inv√°lida‚ùå. Ingresa 1 o 2.")

def jugar():
    print("Bienvenido a Batalla Naval")
    print("1. üéÆüéÆJugar contra la PCüéÆüéÆ")
    print("2. üôç‚Äç‚ôÇÔ∏èüôç‚Äç‚ôÇÔ∏èJugar contra otro jugadorüôç‚Äç‚ôÇÔ∏èüôç‚Äç‚ôÇÔ∏è")
    opcion = ""
    while opcion != '1' and opcion != '2':
        opcion = input("Selecciona una opci√≥n (1 o 2): ")
        if opcion == '1':
            jugar_contra_pc()
        elif opcion == '2':
            jugar_contra_jugador()
        else:
            print("Opci√≥n inv√°lida‚ùå. Ingresa 1 o 2.")


jugar()